playWithMe/
â”œâ”€â”€ CLAUDE.md                                    # ğŸ¯ PRIMARY: Complete project brief, architecture, and standards
â”œâ”€â”€ README.md                                    # Project overview and setup instructions
â”‚
â”œâ”€â”€ docs/                                        # ğŸ“š Complete documentation organized by Epic
â”‚   â”œâ”€â”€ security/
â”‚   â”‚   â”œâ”€â”€ FIREBASE_CONFIG_SECURITY.md         # ğŸ”’ CRITICAL: Firebase security guidelines
â”‚   â”‚   â””â”€â”€ PRE_COMMIT_SECURITY_CHECKLIST.md    # ğŸ”’ MANDATORY: Security checklist before every commit
â”‚   â”œâ”€â”€ testing/
â”‚   â”‚   â””â”€â”€ LOCAL_TESTING_GUIDE.md              # Testing workflows and best practices
â”‚   â””â”€â”€ epic-0/                                  # Foundation documentation
â”‚       â””â”€â”€ story-*/                             # Per-story implementation docs
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ main_dev.dart                           # Development environment entry point
â”‚   â”œâ”€â”€ main_stg.dart                           # Staging environment entry point
â”‚   â”œâ”€â”€ main_prod.dart                          # Production environment entry point
â”‚   â”‚
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ app.dart                            # Root MaterialApp widget
â”‚   â”‚   â””â”€â”€ router/                             # App-wide navigation
â”‚   â”‚
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â””â”€â”€ firebase_options_*.dart         # ğŸ”¥ Environment-specific Firebase configs
â”‚   â”‚   â”œâ”€â”€ di/
â”‚   â”‚   â”‚   â””â”€â”€ injection.dart                  # ğŸ’‰ Dependency injection setup (GetIt)
â”‚   â”‚   â”œâ”€â”€ errors/
â”‚   â”‚   â”‚   â””â”€â”€ failures.dart                   # Error handling models
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ constants.dart                  # App-wide constants
â”‚   â”‚
â”‚   â””â”€â”€ features/
â”‚       â”œâ”€â”€ auth/                               # ğŸ” Authentication feature
â”‚       â”‚   â”œâ”€â”€ data/
â”‚       â”‚   â”‚   â”œâ”€â”€ models/
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ user_model.dart         # Freezed user data model
â”‚       â”‚   â”‚   â””â”€â”€ repositories/
â”‚       â”‚   â”‚       â””â”€â”€ auth_repository.dart    # Auth data layer (Firebase Auth)
â”‚       â”‚   â”œâ”€â”€ domain/
â”‚       â”‚   â”‚   â”œâ”€â”€ entities/
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ user_entity.dart        # Domain user entity
â”‚       â”‚   â”‚   â””â”€â”€ repositories/
â”‚       â”‚   â”‚       â””â”€â”€ auth_repository.dart    # Repository interface
â”‚       â”‚   â””â”€â”€ presentation/
â”‚       â”‚       â”œâ”€â”€ bloc/
â”‚       â”‚       â”‚   â”œâ”€â”€ auth_bloc.dart          # ğŸ¯ Authentication business logic
â”‚       â”‚       â”‚   â”œâ”€â”€ auth_event.dart
â”‚       â”‚       â”‚   â””â”€â”€ auth_state.dart
â”‚       â”‚       â””â”€â”€ pages/
â”‚       â”‚           â””â”€â”€ login_screen.dart       # Login UI
â”‚       â”‚
â”‚       â”œâ”€â”€ groups/                             # ğŸ‘¥ Groups feature
â”‚       â”‚   â”œâ”€â”€ data/
â”‚       â”‚   â”‚   â”œâ”€â”€ models/
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ group_model.dart
â”‚       â”‚   â”‚   â””â”€â”€ repositories/
â”‚       â”‚   â”‚       â””â”€â”€ firestore_group_repository.dart
â”‚       â”‚   â”œâ”€â”€ domain/
â”‚       â”‚   â”‚   â”œâ”€â”€ entities/
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ group_entity.dart
â”‚       â”‚   â”‚   â””â”€â”€ repositories/
â”‚       â”‚   â”‚       â””â”€â”€ group_repository.dart
â”‚       â”‚   â””â”€â”€ presentation/
â”‚       â”‚       â”œâ”€â”€ bloc/
â”‚       â”‚       â”‚   â””â”€â”€ group_bloc.dart
â”‚       â”‚       â””â”€â”€ pages/
â”‚       â”‚           â””â”€â”€ group_list_screen.dart
â”‚       â”‚
â”‚       â””â”€â”€ games/                              # ğŸ Games feature
â”‚           â”œâ”€â”€ data/
â”‚           â”‚   â”œâ”€â”€ models/
â”‚           â”‚   â”‚   â””â”€â”€ game_model.dart
â”‚           â”‚   â””â”€â”€ repositories/
â”‚           â”‚       â””â”€â”€ firestore_game_repository.dart
â”‚           â”œâ”€â”€ domain/
â”‚           â”‚   â”œâ”€â”€ entities/
â”‚           â”‚   â”‚   â””â”€â”€ game_entity.dart
â”‚           â”‚   â””â”€â”€ repositories/
â”‚           â”‚       â””â”€â”€ game_repository.dart
â”‚           â””â”€â”€ presentation/
â”‚               â”œâ”€â”€ bloc/
â”‚               â”‚   â””â”€â”€ game_bloc.dart
â”‚               â””â”€â”€ pages/
â”‚                   â””â”€â”€ game_list_screen.dart
â”‚
â”œâ”€â”€ functions/                                   # â˜ï¸ Firebase Cloud Functions (TypeScript)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts                            # Functions entry point
â”‚   â”‚   â”œâ”€â”€ sendFriendRequest.ts                # Example: Friend request logic
â”‚   â”‚   â”œâ”€â”€ onGameCreated.ts                    # Example: Game creation trigger
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ validation.ts                   # Shared validation utilities
â”‚   â”œâ”€â”€ package.json                            # Node.js dependencies
â”‚   â””â”€â”€ tsconfig.json                           # TypeScript configuration
â”‚
â”œâ”€â”€ test/
â”‚   â”œâ”€â”€ unit/                                   # ğŸ§ª Fast unit tests (mocked dependencies)
â”‚   â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth_bloc_test.dart         # BLoC logic tests
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ auth_repository_test.dart   # Repository interface tests
â”‚   â”‚   â”‚   â”œâ”€â”€ groups/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ group_bloc_test.dart
â”‚   â”‚   â”‚   â””â”€â”€ games/
â”‚   â”‚   â”‚       â””â”€â”€ game_bloc_test.dart
â”‚   â”‚   â””â”€â”€ helpers/
â”‚   â”‚       â”œâ”€â”€ mock_auth_repository.dart       # Mocktail mocks
â”‚   â”‚       â””â”€â”€ fake_user_entity.dart           # Test fakes
â”‚   â”‚
â”‚   â””â”€â”€ widget/                                 # ğŸ¨ Widget rendering tests
â”‚       â”œâ”€â”€ auth/
â”‚       â”‚   â””â”€â”€ login_screen_test.dart
â”‚       â””â”€â”€ groups/
â”‚           â””â”€â”€ group_list_screen_test.dart
â”‚
â”œâ”€â”€ integration_test/                           # ğŸ”¥ End-to-end tests (Firebase Emulator)
â”‚   â”œâ”€â”€ helpers/
â”‚   â”‚   â””â”€â”€ firebase_emulator_helper.dart       # Emulator test utilities
â”‚   â”œâ”€â”€ auth_flow_test.dart                     # Complete authentication flow
â”‚   â””â”€â”€ game_creation_flow_test.dart            # Multi-step game creation
â”‚
â”œâ”€â”€ test_driver/
â”‚   â””â”€â”€ integration_test.dart                   # Driver for flutter drive
â”‚
â”œâ”€â”€ android/
â”‚   â””â”€â”€ app/
â”‚       â””â”€â”€ build.gradle                        # ğŸ¤– Android app-level config (flavors, app IDs)
â”‚
â”œâ”€â”€ ios/
â”‚   â””â”€â”€ Runner/
â”‚       â””â”€â”€ Info.plist                          # ğŸ iOS app configuration
â”‚
â”œâ”€â”€ web/
â”‚   â””â”€â”€ index.html                              # ğŸŒ Web entry point
â”‚
â”œâ”€â”€ firestore.rules                             # ğŸ”’ CRITICAL: Firestore security rules
â”œâ”€â”€ firestore.indexes.json                      # Firestore composite indexes
â”œâ”€â”€ storage.rules                               # Firebase Storage security rules
â”‚
â”œâ”€â”€ .gitignore                                  # ğŸ”’ CRITICAL: Prevents committing secrets
â”œâ”€â”€ .env.example                                # Template for environment variables (NEVER commit real .env)
â”‚
â”œâ”€â”€ pubspec.yaml                                # ğŸ“¦ Flutter dependencies and configuration
â”œâ”€â”€ analysis_options.yaml                       # Dart linter rules
â”‚
â”œâ”€â”€ firebase.json                               # Firebase project configuration
â””â”€â”€ .firebaserc                                 # Firebase environment aliases

KEY PATTERNS TO UNDERSTAND:
========================

1. ğŸ—ï¸ ARCHITECTURE (BLoC + Repository Pattern):
   - UI Layer (presentation/pages) â†’ "Dumb" widgets, display state only
   - BLoC Layer (presentation/bloc) â†’ State management, event handling
   - Repository Layer (data/repositories) â†’ Data source abstraction
   - Domain Layer (domain/entities) â†’ Business models and interfaces

2. ğŸ”¥ FIREBASE INTEGRATION:
   - Firestore: Primary database (users, groups, games collections)
   - Cloud Functions: Server-side logic for cross-user operations
   - Firebase Auth: User authentication
   - Security Rules: firestore.rules enforces data access

3. ğŸ§ª TESTING STRATEGY:
   - Unit tests: Fast, mocked dependencies (Mocktail)
   - Widget tests: UI rendering with fake data
   - Integration tests: E2E flows with Firebase Emulator

4. ğŸŒ MULTI-ENVIRONMENT:
   - dev: Local development (playwithme-dev)
   - stg: Staging (playwithme-stg)
   - prod: Production (playwithme-prod)
   - Controlled via flavors: main_dev.dart, main_stg.dart, main_prod.dart

5. ğŸ”’ SECURITY CRITICAL FILES:
   - .gitignore: Blocks secrets
   - firestore.rules: Data access control
   - PRE_COMMIT_SECURITY_CHECKLIST.md: Mandatory review
   - FIREBASE_CONFIG_SECURITY.md: Configuration guidelines

6. â˜ï¸ CLOUD FUNCTIONS (Backend Logic):
   - TypeScript functions in functions/src/
   - Handle cross-user queries (search users, list members)
   - Firestore triggers (onGameCreated, onInvitationAccepted)
   - Callable functions (sendFriendRequest, acceptFriendRequest)
   - See section 11 in CLAUDE.md for standards

DEPENDENCY FLOW:
===============
Users â†’ My Community (Social Graph) â†’ Groups â†’ Games
- Each layer only queries the layer below
- No cyclic dependencies
- Cloud Functions expose social graph APIs to groups
